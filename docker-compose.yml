version: "3.7"

services:
  users:
    build:
      context: service-users
      args:
        APP_ENV: dev
    image: fiuber.service-users:dev
    container_name: fiuber.service-users.dev
    volumes:
      - ./service-users/src:/opt/app/src
      - ./service-users/test:/opt/app/test
    environment:
      - SERVICE_USERS_PORT=${SERVICE_USERS_PORT}
      - SERVICE_USERS_HOST=${SERVICE_USERS_HOST}
    networks:
      - fiuber
    ports:
      - "${SERVICE_USERS_PORT}:${SERVICE_USERS_PORT}"
    stdin_open: true # docker run -i
    tty: true        # docker run -t
    command: "bash -c 'python3 -m uvicorn src.main:app --host=$${SERVICE_USERS_HOST} --port=$${SERVICE_USERS_PORT} --reload'"
    
networks:
  fiuber:
    driver: bridge
    name: fiuber
